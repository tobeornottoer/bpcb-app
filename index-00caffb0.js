import{K as F,d as Z,r as y,s as T,j as _,e as M,f as H,k as e,p as a,R as j,S as J,g as f,b as U,l as V,A,N as I,H as C,_ as K,a as W,i as ee,q as se,t as ae,w as G,y as D,X as le,G as z}from"./index-02b6e309.js";const oe=d=>F.request("post","/v1/register",{data:d}),L=d=>F.request("post","/v1/ses/code",{data:d}),te=d=>F.request("post","/v1/reset/password",{data:d}),re=d=>F.request("post","/v1/login",{data:d}),O=d=>(j("data-v-2b488175"),d=d(),J(),d),de={class:"forgot-wrap"},ie=O(()=>f("div",{class:"h1"},"Recover password",-1)),ne=O(()=>f("div",{class:"h2"}," Please enter your email to reset your password. Youâ€™ll receive an email with instructions. ",-1)),ue=Z({__name:"forgot",emits:["back"],setup(d,{emit:x}){let R=null;const m=y(0),g=y(),o=T({email:"",password:"",sms_code:"",repeatPassword:""}),t=T({email:[{type:"email",required:!0,message:"This filed is required",trigger:"blur"},{type:"email",message:"Please enter a correct eamil address",trigger:"blur"}],sms_code:[{required:!0,message:"This filed is required",trigger:"blur"}],password:[{required:!0,message:"This filed is required",trigger:"blur"},{pattern:/(?![a-zA-Z]+$)(?![0-9A-Z]+$)(?![a-z0-9]+$).{6,16}/,trigger:"blur",message:"6-16characters starting with a letter, combining at of the following: digits, letters."}],repeatPassword:[{validator:(S,l,n)=>{l===""?n(new Error("This filed is required")):l!==o.password&&o.password?n(new Error("Two password inputs don't match!")):n()},trigger:"blur"}]}),N=I(async()=>{var l;await((l=g.value)==null?void 0:l.validateField(["email"]).catch(()=>{}))&&(R&&clearInterval(R),m.value=60,R=setInterval(()=>{m.value-=1},1e3),await L({email:o.email}))}),$=I(async()=>{var c,k;if(!await((c=g.value)==null?void 0:c.validate().catch(()=>{})))return;const{email:l,sms_code:n,password:u,repeatPassword:E}=o,b=await te({email:l,sms_code:n,password:u,repassed:E});b.code===200&&b.message==="success"?(C.success("Reset successful, please sign in"),(k=g.value)==null||k.resetFields(),setTimeout(()=>{x("back")},1e3)):C.error(b.message||"Reset Error")});return(S,l)=>{const n=_("el-input"),u=_("el-form-item"),E=_("el-button"),b=_("el-form");return M(),H("div",de,[ie,ne,e(b,{model:o,rules:t,"label-width":"164px","label-position":"top",class:"register-form-wrap",ref_key:"formRef",ref:g},{default:a(()=>[e(u,{label:"Email Address",prop:"email"},{default:a(()=>[e(n,{type:"text",modelValue:o.email,"onUpdate:modelValue":l[0]||(l[0]=c=>o.email=c),placehhodel:"Email",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"Verification Code",prop:"sms_code"},{default:a(()=>[e(n,{class:"code",type:"text",modelValue:o.sms_code,"onUpdate:modelValue":l[1]||(l[1]=c=>o.sms_code=c),placehhodel:"code",clearable:""},null,8,["modelValue"]),e(E,{class:"w-[91px]",onClick:U(N),disabled:m.value>0},{default:a(()=>[V(A(m.value>0?`${m.value}S`:"Get Code"),1)]),_:1},8,["onClick","disabled"])]),_:1}),e(u,{label:"Create Password",prop:"password"},{default:a(()=>[e(n,{type:"password",modelValue:o.password,"onUpdate:modelValue":l[2]||(l[2]=c=>o.password=c),placehhodel:"Email",clearable:"","show-password":""},null,8,["modelValue"])]),_:1}),e(u,{label:"Confirm Password",prop:"repeatPassword"},{default:a(()=>[e(n,{type:"password",modelValue:o.repeatPassword,"onUpdate:modelValue":l[3]||(l[3]=c=>o.repeatPassword=c),placehhodel:"Email",clearable:"","show-password":""},null,8,["modelValue"])]),_:1}),e(u,{class:"register-btn-wrap"},{default:a(()=>[e(E,{type:"primary",class:"w-[120px]",onClick:U($)},{default:a(()=>[V("Reset")]),_:1},8,["onClick"]),f("span",{class:"back",onClick:l[4]||(l[4]=c=>x("back"))},"Back to sign in")]),_:1})]),_:1},8,["model","rules"])])}}});const pe=K(ue,[["__scopeId","data-v-2b488175"]]),B=d=>(j("data-v-88620529"),d=d(),J(),d),ce={class:"sign-module-wrap"},me={class:"sign-module-body"},we={class:"register-wrap"},fe=B(()=>f("div",{class:"h1"},"Join / Sign In",-1)),_e=B(()=>f("div",{class:"h2"},"CREATE ACCOUNT",-1)),ge={class:"login-wrap"},ve=B(()=>f("div",{class:"h2"},"SIGN IN",-1)),he=Z({__name:"index",setup(d){const x=W(),R=ee(),m=y(!1);let g=null;const o=y(0),q=y(),t=T({email:"",password:"",sms_code:"",repeatPassword:"",terms:!1}),$=T({email:[{type:"email",required:!0,message:"This filed is required",trigger:"blur"},{type:"email",message:"Please enter a correct eamil address",trigger:"blur"}],sms_code:[{required:!0,message:"This filed is required",trigger:"blur"}],password:[{required:!0,message:"This filed is required",trigger:"blur"},{pattern:/(?![a-zA-Z]+$)(?![0-9A-Z]+$)(?![a-z0-9]+$).{6,16}/,trigger:"blur",message:"6-16characters starting with a letter, combining at of the following: digits, letters."}],repeatPassword:[{validator:(P,s,p)=>{s===""?p(new Error("This filed is required")):s!==t.password&&t.password?p(new Error("Two password inputs don't match!")):p()},trigger:"blur"}]}),S=I(async()=>{var s;await((s=q.value)==null?void 0:s.validateField(["email"]).catch(()=>{}))&&(g&&clearInterval(g),o.value=60,g=setInterval(()=>{o.value-=1},1e3),await L({email:t.email}))}),l=I(async()=>{var v,h;if(!await((v=q.value)==null?void 0:v.validate().catch(()=>{})))return;if(!t.terms){C.error("Please accept the terms of use to continue.");return}const{email:s,password:p,sms_code:i}=t,w=await oe({email:s,password:p,sms_code:i});w.code===200&&w.message==="success"?(C.success("Registration successful, please sign in"),(h=q.value)==null||h.resetFields()):C.error(w.message||"Sign Up Error")}),n=y(),u=T({email:"",password:""}),E=I(async()=>{var w,v,h;if(!await((w=n.value)==null?void 0:w.validate().catch(()=>{})))return;const{email:s,password:p}=u,i=await re({email:s,password:p});if(i.code===200&&i.message==="success"){const{username:r,token:X,identity:Y}=i.data;C.success("Sign in successful"),(v=n.value)==null||v.resetFields();const Q=(h=x.query)!=null&&h.p?decodeURIComponent(x.query.p):"/";le({username:r||Y,roles:["admin"],accessToken:X}),R.push(Q)}else C.error(i.message||"Sign In Error")}),b=()=>{m.value=!0},c=se(()=>z().loginDay),k=y(!1);return ae(k,P=>{z().SET_ISREMEMBERED(P)}),(P,s)=>{const p=_("el-input"),i=_("el-form-item"),w=_("el-button"),v=_("el-checkbox"),h=_("el-form");return M(),H("div",ce,[f("div",me,[f("div",we,[fe,_e,e(h,{model:t,rules:$,"label-width":"164px","label-position":"top",class:"register-form-wrap",ref_key:"registerFormRef",ref:q},{default:a(()=>[e(i,{label:"Email Address",prop:"email"},{default:a(()=>[e(p,{type:"text",modelValue:t.email,"onUpdate:modelValue":s[0]||(s[0]=r=>t.email=r),placehhodel:"Email",clearable:""},null,8,["modelValue"])]),_:1}),e(i,{label:"Verification Code",prop:"sms_code"},{default:a(()=>[e(p,{class:"code",type:"text",modelValue:t.sms_code,"onUpdate:modelValue":s[1]||(s[1]=r=>t.sms_code=r),placehhodel:"code",clearable:""},null,8,["modelValue"]),e(w,{class:"w-[91px]",onClick:U(S),disabled:o.value>0},{default:a(()=>[V(A(o.value>0?`${o.value}S`:"Get Code"),1)]),_:1},8,["onClick","disabled"])]),_:1}),e(i,{label:"Create Password",prop:"password"},{default:a(()=>[e(p,{type:"password",modelValue:t.password,"onUpdate:modelValue":s[2]||(s[2]=r=>t.password=r),placehhodel:"Email",clearable:"","show-password":""},null,8,["modelValue"])]),_:1}),e(i,{label:"Confirm Password",prop:"repeatPassword"},{default:a(()=>[e(p,{type:"password",modelValue:t.repeatPassword,"onUpdate:modelValue":s[3]||(s[3]=r=>t.repeatPassword=r),placehhodel:"Email",clearable:"","show-password":""},null,8,["modelValue"])]),_:1}),e(i,{class:"register-btn-wrap"},{default:a(()=>[e(w,{class:"register-btn",onClick:U(l)},{default:a(()=>[V("Sign Up")]),_:1},8,["onClick"])]),_:1}),e(i,{prop:"terms"},{default:a(()=>[e(v,{class:"rules",modelValue:t.terms,"onUpdate:modelValue":s[4]||(s[4]=r=>t.terms=r)},{default:a(()=>[V("By creating an account, you agree to the Terms of Service and Privacy Policy & Agreement")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),G(f("div",ge,[ve,e(h,{model:u,rules:$,"label-width":"164px","label-position":"top",class:"register-form-wrap",ref_key:"loginFormRef",ref:n},{default:a(()=>[e(i,{label:"Email Address",prop:"email"},{default:a(()=>[e(p,{type:"text",modelValue:u.email,"onUpdate:modelValue":s[5]||(s[5]=r=>u.email=r),placehhodel:"Email",clearable:"",autocomplete:"email"},null,8,["modelValue"])]),_:1}),e(i,{label:"Create Password",prop:"password"},{default:a(()=>[e(p,{type:"password",modelValue:u.password,"onUpdate:modelValue":s[6]||(s[6]=r=>u.password=r),placehhodel:"Email",clearable:"","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),e(i,null,{default:a(()=>[e(v,{class:"rules",modelValue:k.value,"onUpdate:modelValue":s[7]||(s[7]=r=>k.value=r)},{default:a(()=>[V(A(c.value)+" days no need to login",1)]),_:1},8,["modelValue"]),f("span",{class:"forgot",onClick:b},"Forgot password?")]),_:1}),e(w,{class:"login-btn",onClick:U(E)},{default:a(()=>[V("Sign In")]),_:1},8,["onClick"])]),_:1},8,["model","rules"])],512),[[D,!m.value]]),G(e(pe,{onBack:s[8]||(s[8]=r=>m.value=!1)},null,512),[[D,m.value]])])])}}});const ye=K(he,[["__scopeId","data-v-88620529"]]);export{ye as default};
