import{d as U,r as w,Q as H,s as i,e as p,y as N,x as t,g as m,t as _,B as s,C as M,v as e,f as g,i as Y,F as E,aE as W,m as K,q as X,aF as Z,c as ee,b as y,ak as te,p as le,k as ae,w as I,al as se,af as oe,a8 as L,W as ne,aG as re,E as ie,_ as ce}from"./index-61481958.js";import{u as de}from"./useCommon-1972965d.js";const ue={class:"flex"},_e={class:"flex-1 pl-[40px]"},pe={class:"font-bold text-[30px] mt-[20px]"},me={class:"flex-1"},fe=m("h3",{class:"mb-[10px]"},"Processing progress",-1),ve=U({__name:"afterSalesDetail",emits:["handleRevert"],setup(C,{expose:T,emit:k}){const A=()=>{k("handleRevert",o.value)},c=w(!1),o=w(),h=w([]),O=async b=>{const f=await W(b.id);f.code===200&&(c.value=!0,o.value=b,h.value=f.data)},$=()=>{c.value=!1,o.value=void 0,h.value=[]};return H(()=>c.value,b=>{b||(o.value={},h.value=[])}),T({open:O,close:$}),(b,f)=>{const D=i("el-button"),S=i("el-timeline-item"),B=i("el-timeline"),d=i("el-descriptions-item"),a=i("el-descriptions"),l=i("el-dialog");return p(),N(l,{modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=n=>c.value=n),title:"Detail",width:"840px",class:"as-detail-dialog",draggable:""},{default:t(()=>[m("div",ue,[m("div",_e,[m("div",pe,_(o.value.status_text),1),o.value.status_text!=="Canceled"?(p(),N(D,{key:0,class:"mt-[10px] w-[96px]",size:"small",type:"primary",plain:"",onClick:A},{default:t(()=>[s("Revert")]),_:1})):M("",!0)]),m("div",me,[fe,e(B,null,{default:t(()=>[(p(!0),g(E,null,Y(h.value,(n,u)=>(p(),N(S,{key:u,timestamp:n.create_time,color:"#55a3f1"},{default:t(()=>[m("div",null,_(n.operator_text),1),m("div",null,_(n.content),1)]),_:2},1032,["timestamp"]))),128))]),_:1})])]),e(a,{column:2,border:!0},{default:t(()=>[e(d,null,{label:t(()=>[s("Solution")]),default:t(()=>[s(" "+_(o.value.solution),1)]),_:1})]),_:1}),e(a,{column:2,border:!0},{default:t(()=>[e(d,null,{label:t(()=>[s("Product Type")]),default:t(()=>[s(" "+_(o.value.product_type),1)]),_:1}),e(d,null,{label:t(()=>[s("Order No")]),default:t(()=>[s(" "+_(o.value.order_no),1)]),_:1})]),_:1}),e(a,{column:2,border:!0},{default:t(()=>[e(d,null,{label:t(()=>[s("Status ")]),default:t(()=>[s(" "+_(o.value.status_text),1)]),_:1}),e(d,null,{label:t(()=>[s("Create Time ")]),default:t(()=>[s(" "+_(o.value.create_time),1)]),_:1})]),_:1}),e(a,{column:2,border:!0},{default:t(()=>[e(d,null,{label:t(()=>[s("Name")]),default:t(()=>[s(" "+_(o.value.realname),1)]),_:1}),e(d,null,{label:t(()=>[s("Email ")]),default:t(()=>[s(" "+_(o.value.email),1)]),_:1})]),_:1}),e(a,{column:2,border:!0},{default:t(()=>[e(d,null,{label:t(()=>[s("Describe")]),default:t(()=>[s(" "+_(o.value.content),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const z=C=>(le("data-v-7163fc89"),C=C(),ae(),C),be={class:"after-sales-module"},he=z(()=>m("div",{class:"header"},"Quality complaint",-1)),xe={class:"search-form mt-[20px]"},ye=["href"],ge=["href"],ke=["onClick"],we=z(()=>m("div",null,"Online Chat",-1)),Ce=["src"],De=U({__name:"afterSales",setup(C){const{iframeUrl:T,chatVisible:k,handleToChat:A}=de(),c=K({order_no:"",create_time:void 0,status:""}),o=w(),h=L(async()=>{JSON.parse(JSON.stringify(c));const{order_no:a,status:l,create_time:n}=c;f({order_no:a,status:l,create_time:n==null?void 0:n.join("~")})}),O=L(async()=>{var a;(a=o.value)==null||a.resetFields(),h()}),$=[{text:"Last week",value:()=>{const a=new Date,l=new Date;return l.setTime(l.getTime()-3600*1e3*24*7),[l,a]}},{text:"Last month",value:()=>{const a=new Date,l=new Date;return l.setTime(l.getTime()-3600*1e3*24*30),[l,a]}},{text:"Last 3 months",value:()=>{const a=new Date,l=new Date;return l.setTime(l.getTime()-3600*1e3*24*90),[l,a]}}],b=w([]);X(()=>{f()});const f=async a=>{const l=await Z(a);b.value=l.code===200?l.data.list||[]:[]},D={mounted:(a,l)=>{const n=l.value.lastIndexOf("/"),u=l.value.substr(n+1);a.textContent=u}},S=w(),B=a=>{S.value.open(a)},d=async({id:a})=>{ne({type:"warning",message:"Confirm revocation?",customStyle:{"padding-top":"15px"},showCancelButton:!0}).then(async l=>{if(l==="confirm"){const n=await re(a),u=n.code===200&&n.message==="success";ie({type:u?"success":"error",message:n.message||"Revert failed"}),u&&f()}})};return(a,l)=>{const n=i("el-input"),u=i("el-form-item"),P=i("el-date-picker"),V=i("el-option"),q=i("el-select"),R=i("el-button"),J=i("el-form"),v=i("el-table-column"),F=i("el-icon"),Q=i("el-table"),j=i("el-drawer"),G=ee("optimize");return p(),g("div",be,[he,m("div",xe,[e(J,{ref_key:"formRef",ref:o,model:c,"label-width":"170px",inline:!0},{default:t(()=>[e(u,{prop:"order_no",label:"Order ID.:"},{default:t(()=>[e(n,{type:"text",placeholder:"Order No.",modelValue:c.order_no,"onUpdate:modelValue":l[0]||(l[0]=r=>c.order_no=r),modelModifiers:{tirm:!0},clearable:""},null,8,["modelValue"])]),_:1}),e(u,{prop:"create_time",label:"Application Date:"},{default:t(()=>[e(P,{modelValue:c.create_time,"onUpdate:modelValue":l[1]||(l[1]=r=>c.create_time=r),type:"daterange","unlink-panels":"","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date",shortcuts:$,format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{prop:"status",label:"After sales status:"},{default:t(()=>[e(q,{modelValue:c.status,"onUpdate:modelValue":l[2]||(l[2]=r=>c.status=r),placeholder:"the after-sales status",clearable:""},{default:t(()=>[e(V,{value:"0",label:"Pending"}),e(V,{value:"1",label:"Processing"}),e(V,{value:"99",label:"Rescinded"}),e(V,{value:"100",label:"Completed"})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(R,{class:"ml-[170px]",onClick:y(O)},{default:t(()=>[s("reset")]),_:1},8,["onClick"]),e(R,{type:"primary",class:"ml-[10px]",onClick:y(h)},{default:t(()=>[s("search")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),e(Q,{class:"after-sales-table",data:b.value,style:{width:"100%"},"scrollbar-always-on":""},{default:t(()=>[e(v,{prop:"product_type",label:"Product Type",width:"130"}),e(v,{prop:"serial_no",label:"After Sales No",width:"140"}),e(v,{prop:"order_no",label:"Order No",width:"160"}),e(v,{label:"File Name",width:"100"},{default:t(({row:r})=>[(p(!0),g(E,null,Y(r.picture,x=>I((p(),g("a",{download:"",class:"inline-block !underline !text-[#55a3f1]",href:x},null,8,ye)),[[D,x]])),256)),(p(!0),g(E,null,Y(r.attachment,x=>I((p(),g("a",{download:"",class:"inline-block !underline !text-[#55a3f1]",href:x},null,8,ge)),[[D,x]])),256))]),_:1}),e(v,{prop:"create_time",label:"Application Time",width:"180"}),e(v,{prop:"content",label:"Describe",width:"126"}),e(v,{prop:"solution",label:"Solution",width:"100"}),e(v,{prop:"status_text",label:"After sales status",width:"200"}),e(v,{fixed:"right",label:"Operations",width:"260"},{default:t(({row:r})=>[e(R,{link:"",type:"primary",size:"small",onClick:x=>B(r)},{default:t(()=>[s("Detail")]),_:2},1032,["onClick"]),r.status_text!=="Canceled"?I((p(),N(R,{key:0,link:"",type:"primary",size:"small"},{default:t(()=>[s("Revert")]),_:2},1024)),[[G,{event:"click",fn:d,timeout:400,params:{id:r.id}}]]):M("",!0),r.feedback_url?(p(),g("span",{key:1,class:"ml-[10px] primary-color cursor-pointer",onClick:x=>y(A)(r)},[s("customer service"),e(F,{class:"ml-[3px] align-text-bottom"},{default:t(()=>[e(y(se))]),_:1})],8,ke)):M("",!0)]),_:1})]),_:1},8,["data"]),e(ve,{ref_key:"afterSalesDetailRef",ref:S,onHandleRevert:d},null,512),e(j,{class:"chat-drawer",modelValue:y(k),"onUpdate:modelValue":l[4]||(l[4]=r=>te(k)?k.value=r:null),"show-close":!1},{header:t(()=>[we,e(F,{class:"cursor-pointer",onClick:l[3]||(l[3]=r=>k.value=!1)},{default:t(()=>[e(y(oe))]),_:1})]),default:t(()=>[m("iframe",{src:y(T),frameborder:"0"},null,8,Ce)]),_:1},8,["modelValue"])])}}});const Re=ce(De,[["__scopeId","data-v-7163fc89"]]);export{Re as default};
