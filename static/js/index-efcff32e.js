import{K as j,d as q,r as m,s as z,L as A,q as E,t as G,j as n,c as H,e as h,f as x,g as l,k as t,p as o,F as K,z as P,C as $,w as g,y as J,h as Q,l as w,b,A as M,B as W,N,R as X,S as Y,_ as Z}from"./index-02b6e309.js";import{b as ee}from"./index-ced1bd49.js";import{u as S}from"./home-41da435a.js";const se=d=>j.request("get","/v1/message/list",{params:d}),te=d=>(X("data-v-21ef235d"),d=d(),Y(),d),ae={class:"message-module-wrap"},oe={class:"search-form mt-[20px]"},le={class:"message-table"},ne=Q('<div class="message-table-header" data-v-21ef235d><div class="min-w-[236px]" data-v-21ef235d>From</div><div class="min-w-[60px]" data-v-21ef235d>Message</div><div class="min-w-[60px]" data-v-21ef235d>Add Time(GMT+8)</div><div class="min-w-[160px]" data-v-21ef235d>Last Reply Time(GMT+8)</div></div>',1),de={class:"message-table-body"},ce={class:"min-w-[236px]"},re={class:"min-w-[60px]"},ie=["onClick"],ue={class:"min-w-[60px]"},_e={class:"min-w-[160px]"},me=te(()=>l("div",null,"Online Chat",-1)),pe=["src"],ve=q({__name:"index",setup(d){const k=m(),c=z({product_no:"",unread:0}),T=N(()=>{v(Object.assign({...c}))}),B=N(()=>{var a;(a=k.value)==null||a.resetFields(),v()}),u=m([]);A(()=>{v()});const v=async a=>{var r;const s=await se(a);s.code===200&&(u.value=((r=s.data)==null?void 0:r.list)||[])},I=E(()=>S().messages),V=m(),f=m(),_=m(!1),L=()=>{_.value=!1},R=a=>{V.value=a.detail_url,f.value=a,_.value=!0};return G(()=>_.value,a=>{var s;if(!a&&((s=f.value)==null?void 0:s.unread)==1){const r=I.value-1;S().setMessageNumber(r),u.value.forEach(i=>{var p;i.id===((p=f.value)==null?void 0:p.id)&&(i.unread=0)})}}),(a,s)=>{const r=n("el-input"),i=n("el-form-item"),p=n("el-checkbox"),y=n("el-button"),U=n("el-form"),D=n("el-empty"),F=n("el-icon"),O=n("el-drawer"),C=H("time-format");return h(),x("div",ae,[l("div",oe,[t(U,{ref_key:"formRef",ref:k,model:c,"label-width":"170px",inline:!0},{default:o(()=>[t(i,{prop:"product_no",label:"Order ID/Product No.:"},{default:o(()=>[t(r,{type:"text",modelValue:c.product_no,"onUpdate:modelValue":s[0]||(s[0]=e=>c.product_no=e),modelModifiers:{tirm:!0},clearable:""},null,8,["modelValue"])]),_:1}),t(i,{prop:"unread"},{default:o(()=>[t(p,{class:"ml-[10px]",modelValue:c.unread,"onUpdate:modelValue":s[1]||(s[1]=e=>c.unread=e),"true-label":1,"false-label":0},{default:o(()=>[w("Unread")]),_:1},8,["modelValue"])]),_:1}),t(i,null,{default:o(()=>[t(y,{class:"ml-[10px]",onClick:b(B)},{default:o(()=>[w("reset")]),_:1},8,["onClick"]),t(y,{type:"primary",class:"ml-[10px]",onClick:b(T)},{default:o(()=>[w("search")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),l("div",le,[ne,l("div",de,[u.value.length?(h(!0),x(K,{key:0},P(u.value,e=>(h(),x("div",{class:"message-table-item",key:e.id},[l("div",ce,M(e.sender),1),l("div",re,[l("span",{class:W(["message-text",{unread:e.unread===1}]),onClick:fe=>R(e)},M(e.content),11,ie)]),g(l("div",ue,null,512),[[C,e.create_time]]),g(l("div",_e,null,512),[[C,e.last_time]])]))),128)):$("",!0),g(t(D,null,null,512),[[J,!u.value.length]])])]),t(O,{class:"chat-drawer",modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=e=>_.value=e),"show-close":!1},{header:o(()=>[me,t(F,{onClick:L},{default:o(()=>[t(b(ee))]),_:1})]),default:o(()=>[l("iframe",{src:V.value,frameborder:"0"},null,8,pe)]),_:1},8,["modelValue"])])}}});const we=Z(ve,[["__scopeId","data-v-21ef235d"]]);export{we as default};
