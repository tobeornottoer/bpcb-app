import{d as ee,r as _,Q as te,s as m,e as h,y as Y,x as a,g as o,v as l,B as d,b as N,f as w,i as ve,F as be,w as Q,U as Z,a8 as H,m as ae,ad as Se,E as J,t as p,a2 as Ue,h as qe,q as De,l as K,an as Be,ao as Fe,c as Te,C as S,X as oe,p as Ae,k as Ee,a0 as le,$ as Qe,ap as ze,a9 as Me,aq as Le,ae as fe,ar as je,as as Je,n as Ye,_ as He}from"./index-61481958.js";import{b as We}from"./config-8e92375e.js";import{s as Xe,a as Ge,g as Ke,b as Ze,c as et,F as tt}from"./upload.vue_vue_type_style_index_0_lang-e3087c3c.js";import{_ as st}from"./pay-0b545f01.js";import{a as ot}from"./awaitPayment-33aff63c.js";import"./address-6fe9af1a.js";const lt=o("div",null," * Do you want to cancel the order? Please choose the reason for the cancel to help us do better. Reason for choosing to cancel: ",-1),at={class:"mt-[15px]"},nt={class:"dialog-footer"},rt=ee({__name:"remove",emits:["confirm"],setup(I,{expose:B,emit:F}){const u=_(!1),c=_(""),O=_(""),R=["I want to cancel this order instantly","The order processing time is too long","The price has been raised","Wrong order(parameter,file error)","Delivery is too long","Change the data","The customer service did not respond to my question(s)","Product/material is out of stock","Other reasons"],i=_(),C=async b=>{i.value=b,u.value=!0},P=H(()=>{const b=c.value=="Other reasons"?O.value:c.value,r={order_id:i.value,reason:b};F("confirm",r),u.value=!1});return te(()=>u.value,b=>{b||(i.value=void 0,c.value="",O.value="")}),B({open:C,close:P}),(b,r)=>{const g=m("el-option"),y=m("el-select"),V=m("el-input"),$=m("el-button"),U=m("el-dialog");return h(),Y(U,{modelValue:u.value,"onUpdate:modelValue":r[3]||(r[3]=f=>u.value=f),title:"Request Order Remove",width:"450px","modal-class":"order-delete-dialog common-dialog",draggable:""},{footer:a(()=>[o("span",nt,[l($,{onClick:r[2]||(r[2]=f=>u.value=!1)},{default:a(()=>[d("Cancel")]),_:1}),l($,{type:"primary",onClick:N(P)},{default:a(()=>[d(" Confirm ")]),_:1},8,["onClick"])])]),default:a(()=>[lt,l(y,{class:"mt-[5px]",modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=f=>c.value=f),placeholder:"select here"},{default:a(()=>[(h(),w(be,null,ve(R,f=>l(g,{key:f,value:f,lable:f},null,8,["value","lable"])),64))]),_:1},8,["modelValue"]),Q(o("div",at," Please fill in the specific reason (optional) ",512),[[Z,c.value=="Other reasons"]]),Q(l(V,{type:"textarea",row:4,modelValue:O.value,"onUpdate:modelValue":r[1]||(r[1]=f=>O.value=f),modelModifiers:{trim:!0}},null,8,["modelValue"]),[[Z,c.value=="Other reasons"]])]),_:1},8,["modelValue"])}}});const dt={class:"dialog-footer"},ct=ee({__name:"editPONumber",emits:["confirm"],setup(I,{expose:B,emit:F}){const u=_(!1),c=_(),O=ae({product_order_number:""}),R=ae({product_order_number:[{required:!0,message:"This field is required"}]}),i=_(),C=async b=>{i.value=b,u.value=!0},P=H(async()=>{var r;await((r=c.value)==null?void 0:r.validate().catch(()=>{}))&&(F("confirm",{order_id:i.value,product_order_number:O.product_order_number}),u.value=!1)});return te(()=>u.value,b=>{var r;b||((r=c.value)==null||r.resetFields(),i.value="")}),B({open:C,close:P}),(b,r)=>{const g=m("el-input"),y=m("el-form-item"),V=m("el-form"),$=m("el-button"),U=m("el-dialog");return h(),Y(U,{modelValue:u.value,"onUpdate:modelValue":r[2]||(r[2]=f=>u.value=f),title:"PO Number",width:"360px","modal-class":"order-delete-dialog common-dialog",draggable:""},{footer:a(()=>[o("span",dt,[l($,{onClick:r[1]||(r[1]=f=>u.value=!1)},{default:a(()=>[d("Cancel")]),_:1}),l($,{type:"primary",onClick:N(P)},{default:a(()=>[d(" Confirm ")]),_:1},8,["onClick"])])]),default:a(()=>[l(V,{model:O,rules:R,ref_key:"formRef",ref:c},{default:a(()=>[l(y,{prop:"product_order_number"},{default:a(()=>[l(g,{modelValue:O.product_order_number,"onUpdate:modelValue":r[0]||(r[0]=f=>O.product_order_number=f),modelModifiers:{trim:!0},clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});const it={class:"header flex items-center"},ut=["src"],_t=o("span",{class:"text-slate-400 ml-[20px] text-[13px]"},"The PCBs above need assembly",-1),mt={class:"text-right"},pt={class:"text-red-500"},ft={class:"text-right"},vt={class:"text-red-500"},bt={class:"dialog-footer"},ht=ee({__name:"assemblyDialog",props:{relatesInfo:{required:!0,type:Object}},emits:["confirm"],setup(I,{expose:B,emit:F}){const u=I,c=_(!1),O=()=>{c.value=!0},R=H(async()=>{var $,U;if(!(($=C.value)==null?void 0:$.validate().catch(()=>{})))return;const g=(U=C.value)==null?void 0:U.getData(),{product_no:y}=u.relatesInfo,V=await Se("assembly",Object.assign(g,{txtPCBNos:y,radPCBRelation:"Yes"}));V.code===200&&V.message==="success"&&(F("confirm"),J.success("Save successful!"),c.value=!1)});te(()=>c.value,r=>{var g,y;if(!r)(g=C.value)==null||g.clear();else{const{product_no:V}=u.relatesInfo;(y=C.value)==null||y.setFormData({txtPCBNos:V,radPCBRelation:"Yes"})}});const i=_(),C=_();let P=null;const b=async r=>{P&&clearTimeout(P),P=setTimeout(async()=>{const{product_no:g}=u.relatesInfo,y=await Ke("assembly",Object.assign(r,{txtPCBNos:g,radPCBRelation:"Yes"}));y.code===200&&y.message==="success"&&(i.value=y.data)},500)};return B({open:O,close:R}),(r,g)=>{const y=m("el-descriptions-item"),V=m("el-descriptions"),$=m("el-icon"),U=m("el-checkbox"),f=m("el-button"),A=m("el-dialog");return h(),Y(A,{modelValue:c.value,"onUpdate:modelValue":g[1]||(g[1]=T=>c.value=T),title:"+ PCB Assembly",width:"880px","modal-class":"qoute-assembly-dialog common-dialog",draggable:""},{footer:a(()=>[o("span",bt,[l(f,{onClick:g[0]||(g[0]=T=>c.value=!1)},{default:a(()=>[d("Cancel")]),_:1}),l(f,{type:"primary",onClick:N(R)},{default:a(()=>[d("Submit Order Now")]),_:1},8,["onClick"])])]),default:a(()=>{var T,z,M,W;return[l(V,{column:2,size:"small",border:!0},{default:a(()=>[l(y,{label:"PCB Order NO."},{default:a(()=>[d(p(I.relatesInfo.product_no),1)]),_:1}),l(y,{label:"Quantity"},{default:a(()=>[d(p(I.relatesInfo.quantity+"pcs, "+I.relatesInfo.title),1)]),_:1})]),_:1}),l(Ge,{ref_key:"assemblyModuleRef",ref:C,"hide-parameters":!0,"form-monitor":!0,"form-size":"small",onChangeForm:b},{header:a(()=>[o("div",it,[l(U,{class:"inline-flex-checkbox pointer-events-none",checked:!0},{default:a(()=>[o("img",{src:N(Xe),class:"mr-[8px]"},null,8,ut),d(" Assembly Service "),l($,{class:"ml-[6px]"},{default:a(()=>[l(N(Ue))]),_:1})]),_:1}),_t])]),_:1},512),o("div",mt,[d(" Assembly Service Cost: "),o("span",pt,"$ "+p(((z=(T=i.value)==null?void 0:T.assembly)==null?void 0:z.total)||"?"),1)]),o("div",ft,[d(" Total: "),o("span",vt,"$ "+p(((W=(M=i.value)==null?void 0:M.pcb)==null?void 0:W.total)||"?"),1)])]}),_:1},8,["modelValue"])}}});const D=I=>(Ae("data-v-2810e028"),I=I(),Ee(),I),yt={class:"under-review-wrap"},gt={class:"header"},xt={class:"search-form mt-[20px]"},kt={class:"order-table"},Ct={class:"order-table-header"},wt={class:"min-w-[346px] name-cell"},Ot={class:"ml-0 w-[70px]"},Vt=D(()=>o("div",null,"Product Name & Details",-1)),$t=D(()=>o("div",{class:"min-w-[140px]"},"Quantity",-1)),Rt=D(()=>o("div",{class:"min-w-[60px]"},"Price",-1)),Pt=D(()=>o("div",{class:"min-w-[130px]"},"Product files",-1)),Nt=D(()=>o("div",{class:"min-w-[160px]"},"Status",-1)),It={class:"order-table-body"},St={class:"checkbox-wrap mb-[5px]"},Ut={class:"ml-[8px] align-text-bottom"},qt={class:"order-table-item"},Dt={class:"min-w-[346px]"},Bt={class:"product-detail"},Ft=["onClick"],Tt=D(()=>o("span",{class:"text"},"Product No.: ",-1)),At={key:0},Et=D(()=>o("span",{class:"text"},"Solder mask: ",-1)),Qt={key:1},zt=D(()=>o("span",{class:"text"},"Silkscreen: ",-1)),Mt={class:"order-type"},Lt=D(()=>o("span",{class:"text yy-time"}," Build Time: ",-1)),jt=["onClick"],Jt={class:"min-w-[140px] !ml-[0]"},Yt={class:"min-w-[60px]"},Ht={class:"font-bold"},Wt={class:"text"},Xt={class:"min-w-[130px]"},Gt={class:"mb-[3px]"},Kt={key:0,class:"text-[red] mb-[3px]"},Zt={class:"mb-[3px]"},es=["onClick"],ts=["onClick"],ss=["onClick"],os=["onClick"],ls={class:"min-w-[160px]"},as={key:0,class:"mb-[3px]"},ns=["onClick"],rs={class:"mb-[5px]"},ds={key:1,class:"mb-[5px]"},cs={class:"mb-[5px]"},is={class:"order-footer-wrap"},us={class:"order-footer-checkbox"},_s={class:"order-text mt-[10px]"},ms={class:"font-blod"},ps={class:"order-text text-[18px]"},fs={class:"font-blod text-red-600"},vs={class:"text-right btn-wrap"},bs=ee({__name:"underReview",setup(I){const B=qe(),F=()=>{B.push("/instantQuote")},u=ae({product_no:"",title:"",product_order_number:""}),c=_([]);De(async()=>{await A()});const O=e=>e.type==="fpc_pcb"?e.pcb_type==="Rigid-Flex Board"?"rigid_img":"flexible_img":e.type+"_img",R=_(!1),i=_([]),C=K(()=>{var t;return(t=c.value)==null?void 0:t.reduce((n,v)=>v.status!==1?n:n.concat(v.id),[])});te(()=>C.value,e=>{i.value=i.value.reduce((t,n)=>e.includes(n.id)?t.concat(n.id):t,[])});const P=K(()=>{var e;return!!((e=C.value)!=null&&e.lenght)}),b=K(()=>{var t;return((t=c.value)==null?void 0:t.reduce((n,v)=>i.value.includes(v.id)?n+=+v.price:n,0)).toFixed(2)}),r=K(()=>b.value),g=e=>{var n,v,k,q,G;const t=(n=i.value)==null?void 0:n.includes(e);i.value=t?(v=i.value)==null?void 0:v.filter(j=>j!==e):(k=i.value)==null?void 0:k.concat(e),R.value=((q=i.value)==null?void 0:q.length)===((G=C.value)==null?void 0:G.length)},y=e=>{i.value=e?C.value:[]},V=async e=>{const t=e!=null&&e.id?[e==null?void 0:e.id]:i.value,n=Me.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});(await ot().getAwaitPaymentInfo({id:t})).code===200&&B.push("/member/awaitingPayment"),n.close()},$=_(),U=H(async()=>{const e=JSON.parse(JSON.stringify(u));await A(e)}),f=H(async()=>{var e;(e=$.value)==null||e.resetFields(),await A()}),A=async e=>{const t=await Be(e);return t.code===200&&t.message==="success"&&(c.value=t.data),Promise.resolve(t)},T=_(),z=e=>{var t;(t=T.value)==null||t.open(e)},M=_(),W=async e=>{const t=await Le(e);t.code===200&&t.message==="success"&&(J.success("Remove successfully"),i.value=i.value.filter(n=>n.id!=e.order_id),fe().SET_ORDER_COUNT({cart_number:fe().order.cart_number-1}))},he=e=>{var t;(t=M.value)==null||t.open(e)},ne=_(),ye=e=>{var t;(t=ne.value)==null||t.open(e)},ge=async e=>{const t=await je(e);t.code===200&&t.message==="success"&&J.success("Update PO Number successfully")},E=_(),re=_(),xe=e=>{var t;(t=re.value)==null||t.open(e.id),E.value=e},ke=async e=>{const t=await et(e);t.code===200&&t.message==="success"&&(J.success("Update File successfully"),e.id.forEach(n=>{if(n===E.value.id)for(let[v,k]of Object.entries(e.urls))k&&(E.value[`${v}_file`]=k)}))},L=(e="")=>{let t="";if(e){const n=e.lastIndexOf("/")+1;t=e.substr(n)?e.substr(n):""}return t},X=e=>{const t=We+e,n=L(e);tt.saveAs(t,n)},de=_({}),ce=_(),Ce=e=>{var t;de.value=e,(t=ce.value)==null||t.open()},we=async()=>{await A()},ie=_(!1),ue=_();Fe(ue,([{isIntersecting:e}],t)=>{ie.value=!e});let se=null;const _e=_(),Oe=e=>{_e.value=JSON.parse(JSON.stringify(e)),E.value=e},Ve=async(e,t,n)=>{e||(n.quantity=t),se&&clearTimeout(se),se=setTimeout(async()=>{const v=await Je(n.id,{quantity:e});v.code===200&&v.message==="success"?(J.success("Update quantity successfully"),E.value=v.data,c.value.forEach(k=>{k.id===n.id&&Object.assign(k,v.data)})):(c.value.forEach(k=>{k.id===n.id&&(k.quantity=n.value.quantity)}),E.value.quantity=n.value.quantity)},500)},$e=(e,t)=>{Ye(()=>{var n;e||(t.quantity=(n=_e.value)==null?void 0:n.quantity)})};return(e,t)=>{const n=m("el-icon"),v=m("el-input"),k=m("el-form-item"),q=m("el-button"),G=m("el-form"),j=m("el-checkbox"),Re=m("el-input-number"),Pe=m("el-empty"),me=Te("optimize");return h(),w("div",yt,[o("div",gt,[d(" Shopping Cart / Order Review "),o("span",{class:"add",onClick:F},[l(n,{class:"mr-[6px] align-text-bottom"},{default:a(()=>[l(N(le))]),_:1}),d("Add new item")])]),o("div",xt,[l(G,{ref_key:"formRef",ref:$,model:u,"label-width":"170px",inline:!0},{default:a(()=>[l(k,{prop:"product_no",label:"Order ID/Product No.:"},{default:a(()=>[l(v,{type:"text",modelValue:u.product_no,"onUpdate:modelValue":t[0]||(t[0]=s=>u.product_no=s),modelModifiers:{tirm:!0},clearable:""},null,8,["modelValue"])]),_:1}),l(k,{prop:"title",label:"PCB file Name: "},{default:a(()=>[l(v,{type:"text",modelValue:u.title,"onUpdate:modelValue":t[1]||(t[1]=s=>u.title=s),modelModifiers:{tirm:!0},clearable:""},null,8,["modelValue"])]),_:1}),l(k,{prop:"product_order_number",label:"PO Number: "},{default:a(()=>[l(v,{type:"text",modelValue:u.product_order_number,"onUpdate:modelValue":t[2]||(t[2]=s=>u.product_order_number=s),modelModifiers:{tirm:!0},clearable:""},null,8,["modelValue"])]),_:1}),l(k,null,{default:a(()=>[l(q,{class:"ml-[10px]",onClick:N(f)},{default:a(()=>[d("reset")]),_:1},8,["onClick"]),l(q,{type:"primary",class:"ml-[10px]",onClick:N(U)},{default:a(()=>[d("search")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),o("div",kt,[o("div",Ct,[o("div",wt,[o("div",Ot,[l(j,{modelValue:R.value,"onUpdate:modelValue":t[3]||(t[3]=s=>R.value=s),onChange:y,disabled:P.value,class:"mr-[5px]"},{default:a(()=>[d("All")]),_:1},8,["modelValue","disabled"])]),Vt]),$t,Rt,Pt,Nt]),o("div",It,[c.value.length?(h(!0),w(be,{key:0},ve(c.value,(s,Ne)=>{var pe;return h(),w("div",{class:oe(["order-table-container",{unaudited:s.status!==1}]),key:s.id},[o("div",St,[l(j,{"model-value":(pe=i.value)==null?void 0:pe.includes(s.id),onChange:x=>g(s.id),disabled:s.status!==1},null,8,["model-value","onChange","disabled"]),o("span",Ut,"Add Time: "+p(s.create_time),1)]),o("div",qt,[o("div",Dt,[o("div",{class:oe([O(s),"product-img"])},null,2),o("div",Bt,[o("div",{class:"title",onClick:x=>z(s.id)},p(s.title),9,Ft),o("div",null,[Tt,d(p(s.product_no),1)]),s.radSolderColor?(h(),w("div",At,[Et,d(p(s.radSolderColor),1)])):S("",!0),s.radFontColor?(h(),w("div",Qt,[zt,d(p(s.radFontColor),1)])):S("",!0),o("div",Mt,"["+p(s.order_type)+"]",1),o("div",null,[Lt,d(p(s.build_time),1)]),o("div",{class:"detail-view cursor-pointer",onClick:x=>z(s.id)}," Detail View ",8,jt)])]),o("div",Jt,[l(Re,{size:"small",min:1,modelValue:s.quantity,"onUpdate:modelValue":x=>s.quantity=x,onInput:x=>$e(x,s),"value-on-clear":s.quantity,onClick:x=>Oe(s),onChange:(x,Ie)=>Ve(x,Ie,s)},null,8,["modelValue","onUpdate:modelValue","onInput","value-on-clear","onClick","onChange"])]),o("div",Yt,[o("div",Ht,"$ "+p(s.price||"?"),1),o("div",Wt,"("+p(s.weight)+"kg)",1)]),o("div",Xt,[Q(o("div",Gt," File not upload. ",512),[[Z,!(s.gerber_file||s.bom_file||s.centroid_file||s.other_file)]]),s.status===-1&&s.review_fail_reason?(h(),w("div",Kt,p(s.review_fail_reason),1)):S("",!0),o("div",Zt,[l(q,{type:"primary",size:"small",onClick:x=>xe(s)},{default:a(()=>[l(n,{class:"mr-[5px]"},{default:a(()=>[l(N(Qe))]),_:1}),d("Add File")]),_:2},1032,["onClick"])]),s.gerber_file?(h(),w("a",{key:1,class:"file-link",onClick:x=>X(s.gerber_file)},p(L(s.gerber_file)),9,es)):S("",!0),s.bom_file?(h(),w("a",{key:2,class:"file-link",onClick:x=>X(s.bom_file)},p(L(s.bom_file)),9,ts)):S("",!0),s.centroid_file?(h(),w("a",{key:3,class:"file-link",onClick:x=>X(s.centroid_file)},p(L(s.centroid_file)),9,ss)):S("",!0),s.other_file?(h(),w("a",{key:4,class:"file-link",onClick:x=>X(s.other_file)},p(L(s.other_file)),9,os)):S("",!0)]),o("div",ls,[s.status!==1?(h(),w("div",as," Not Completed ")):S("",!0),o("div",{class:"mb-[3px] cursor-pointer",onClick:x=>ye(s.id)}," Edit PO No. ",8,ns),o("div",rs,[l(q,{type:"danger",size:"small",onClick:x=>he(s.id)},{default:a(()=>[l(n,{class:"mr-[5px]"},{default:a(()=>[l(N(ze))]),_:1}),d("Remove Order")]),_:2},1032,["onClick"])]),["SMD","assembly"].includes(s.type)?S("",!0):(h(),w("div",ds,[l(q,{type:"primary",size:"small",onClick:x=>Ce(s)},{default:a(()=>[l(n,{class:"mr-[5px]"},{default:a(()=>[l(N(le))]),_:1}),d("PCB Assembly")]),_:2},1032,["onClick"])])),o("div",cs,[Q((h(),Y(q,{type:"primary",disabled:s.status!==1,size:"small",class:"w-[120px]"},{default:a(()=>[d("checkout")]),_:2},1032,["disabled"])),[[me,{event:"click",fn:V,timeout:400,params:{id:s.id}}]])])])]),Ne==c.value.length-1?(h(),w("div",{key:0,ref_for:!0,ref_key:"targetObserver",ref:ue,class:"index-wrap"},null,512)):S("",!0)],2)}),128)):S("",!0),Q(l(Pe,null,null,512),[[Z,!c.value.length]])])]),o("div",{class:oe(["order-footer-wrap",{"is-fixed":ie.value}])},[o("div",is,[o("div",us,[l(j,{modelValue:R.value,"onUpdate:modelValue":t[4]||(t[4]=s=>R.value=s),onChange:y,disabled:P.value},{default:a(()=>[d("Check all")]),_:1},8,["modelValue","disabled"]),o("span",{class:"add",onClick:F},[l(n,{class:"mr-[6px] align-text-bottom"},{default:a(()=>[l(N(le))]),_:1}),d("Add new item")])]),o("div",_s,[d(" Subtotal("+p(i.value.length)+" Items): ",1),o("span",ms,"$ "+p(Number(b.value)?b.value:"--"),1)]),o("div",ps,[d(" All Total: "),o("span",fs,"$ "+p(Number(r.value)?b.value:"--"),1)]),o("div",vs,[Q((h(),Y(q,{type:"primary",disabled:!i.value.length},{default:a(()=>[d("Proceed to checkout")]),_:1},8,["disabled"])),[[me,{event:"click",fn:V,timeout:400}]])])])],2),l(st,{ref_key:"orderDetailRef",ref:T},null,512),l(rt,{ref_key:"orderRemoveDialogRef",ref:M,onConfirm:W},null,512),l(ct,{ref_key:"editPONumberRef",ref:ne,onConfirm:ge},null,512),l(Ze,{ref_key:"uploadRef",ref:re,onConfirm:ke},null,512),l(ht,{ref_key:"assemblyDialogRef",ref:ce,"relates-info":de.value,onConfirm:we},null,8,["relates-info"])])}}});const ws=He(bs,[["__scopeId","data-v-2810e028"]]);export{ws as default};
