import{G as L,d as G,r as m,m as j,q,l as z,Q as A,s as n,c as H,e as h,f as x,g as l,v as a,x as o,F as P,i as Q,C as X,w as g,U as $,j as J,B as w,b,t as M,X as K,af as W,a8 as N,ae as S,p as Y,k as Z,_ as ee}from"./index-61481958.js";const se=c=>L.request("get","/v1/message/list",{params:c}),ae=c=>(Y("data-v-0561e5c2"),c=c(),Z(),c),te={class:"message-module-wrap"},oe={class:"search-form mt-[20px]"},le={class:"message-table"},ne=J('<div class="message-table-header" data-v-0561e5c2><div class="min-w-[236px]" data-v-0561e5c2>From</div><div class="min-w-[60px]" data-v-0561e5c2>Message</div><div class="min-w-[60px]" data-v-0561e5c2>Add Time(GMT+8)</div><div class="min-w-[160px]" data-v-0561e5c2>Last Reply Time(GMT+8)</div></div>',1),ce={class:"message-table-body"},de={class:"min-w-[236px]"},re={class:"min-w-[60px]"},ie=["onClick"],_e={class:"min-w-[60px]"},ue={class:"min-w-[160px]"},me=ae(()=>l("div",null,"Online Chat",-1)),pe=["src"],ve=G({__name:"index",setup(c){const k=m(),d=j({product_no:"",unread:0}),T=N(()=>{v(Object.assign({...d}))}),U=N(()=>{var t;(t=k.value)==null||t.resetFields(),v()}),_=m([]);q(()=>{v()});const v=async t=>{var r;const s=await se(t);s.code===200&&(_.value=((r=s.data)==null?void 0:r.list)||[])},O=z(()=>S().order.message),C=m(),f=m(),u=m(!1),R=()=>{u.value=!1},B=t=>{C.value=t.detail_url,f.value=t,u.value=!0};return A(()=>u.value,t=>{var s;if(!t&&((s=f.value)==null?void 0:s.unread)==1){const r=O.value-1;S().SET_ORDER_COUNT({message:r}),_.value.forEach(i=>{var p;i.id===((p=f.value)==null?void 0:p.id)&&(i.unread=0)})}}),(t,s)=>{const r=n("el-input"),i=n("el-form-item"),p=n("el-checkbox"),V=n("el-button"),D=n("el-form"),I=n("el-empty"),E=n("el-icon"),F=n("el-drawer"),y=H("time-format");return h(),x("div",te,[l("div",oe,[a(D,{ref_key:"formRef",ref:k,model:d,"label-width":"170px",inline:!0},{default:o(()=>[a(i,{prop:"product_no",label:"Order ID/Product No.:"},{default:o(()=>[a(r,{type:"text",modelValue:d.product_no,"onUpdate:modelValue":s[0]||(s[0]=e=>d.product_no=e),modelModifiers:{tirm:!0},clearable:""},null,8,["modelValue"])]),_:1}),a(i,{prop:"unread"},{default:o(()=>[a(p,{class:"ml-[10px]",modelValue:d.unread,"onUpdate:modelValue":s[1]||(s[1]=e=>d.unread=e),"true-label":1,"false-label":0},{default:o(()=>[w("Unread")]),_:1},8,["modelValue"])]),_:1}),a(i,null,{default:o(()=>[a(V,{class:"ml-[10px]",onClick:b(U)},{default:o(()=>[w("reset")]),_:1},8,["onClick"]),a(V,{type:"primary",class:"ml-[10px]",onClick:b(T)},{default:o(()=>[w("search")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),l("div",le,[ne,l("div",ce,[_.value.length?(h(!0),x(P,{key:0},Q(_.value,e=>(h(),x("div",{class:"message-table-item",key:e.id},[l("div",de,M(e.sender),1),l("div",re,[l("span",{class:K(["message-text",{unread:e.unread===1}]),onClick:fe=>B(e)},M(e.content),11,ie)]),g(l("div",_e,null,512),[[y,e.create_time]]),g(l("div",ue,null,512),[[y,e.last_time]])]))),128)):X("",!0),g(a(I,null,null,512),[[$,!_.value.length]])])]),a(F,{class:"chat-drawer",modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=e=>u.value=e),"show-close":!1},{header:o(()=>[me,a(E,{onClick:R},{default:o(()=>[a(b(W))]),_:1})]),default:o(()=>[l("iframe",{src:C.value,frameborder:"0"},null,8,pe)]),_:1},8,["modelValue"])])}}});const xe=ee(ve,[["__scopeId","data-v-0561e5c2"]]);export{xe as default};
